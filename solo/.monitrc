set daemon 30
set log syslog
set httpd port 2812 and
    use address localhost  # only accept connection from localhost (drop if you use M/Monit)
    allow localhost        # allow localhost to connect to the server and
    allow admin:monit      # require user 'admin' with password 'monit'
    #with ssl {            # enable SSL/TLS and set path to server certificate
    #    pemfile: /etc/ssl/certs/monit.pem
    #}

check process lute-http matching "/opt/lute-http/lute-http"
    start program = "/bin/sh -c '/opt/lute-http/start-lute-http.sh'" with timeout 5 seconds
    stop program = "/bin/sh -c '/opt/lute-http/stop-lute-http.sh'" with timeout 5 seconds
    if failed port 8249 protocol http then restart

check process solo matching "java -cp WEB-INF/lib/\*:WEB-INF/classes org\.b3log\.solo\.Starter"
    start program = "/bin/sh -c '/opt/solo/start-solo.sh'" with timeout 5 seconds
    stop program = "/bin/sh -c '/opt/solo/stop-solo.sh'" with timeout 5 seconds
    if failed port 8080 protocol http then restart
    depends on lute-http

check file lute-http.log with path /opt/lute-http/lute-http.log
    if size > 10 MB then exec "/usr/bin/truncate -s 0 /opt/lute-http/lute-http.log"

check file solo.log with path /opt/solo/solo.log
    if size > 10 MB then exec "/usr/bin/truncate -s 0 /opt/solo/solo.log"
